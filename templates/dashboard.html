<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŒ³ Forest Analysis Dashboard</title>
    
    <!-- CSS Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --forest-green: #2d5016;
            --light-green: #4a7c59;
            --nature-green: #8fbc8f;
            --warm-orange: #ff8c42;
            --alert-red: #e74c3c;
            --safe-blue: #3498db;
            --background: #f8fffe;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--background);
            color: #2c3e50;
        }

        .navbar {
            background: linear-gradient(135deg, var(--forest-green), var(--light-green));
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .card-header {
            background: linear-gradient(135deg, var(--light-green), var(--nature-green));
            color: white;
            border-radius: 15px 15px 0 0 !important;
            border: none;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--forest-green);
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 1rem 0;
        }

        #map {
            height: 500px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .risk-indicator {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .risk-critical { background: var(--alert-red); color: white; }
        .risk-high { background: #ff6b6b; color: white; }
        .risk-medium { background: var(--warm-orange); color: white; }
        .risk-low { background: var(--safe-blue); color: white; }

        .table {
            border-radius: 10px;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--forest-green), var(--light-green));
            border: none;
            border-radius: 25px;
            padding: 10px 30px;
            font-weight: 500;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--light-green), var(--forest-green));
            transform: translateY(-2px);
        }

        .sidebar {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }

        .sidebar h6 {
            color: var(--forest-green);
            margin-bottom: 1rem;
            font-weight: bold;
        }

        .filter-group {
            margin-bottom: 1.5rem;
        }

        .filter-group label {
            font-size: 0.9rem;
            font-weight: 500;
            color: #495057;
        }

        .form-control, .form-select {
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--light-green);
            box-shadow: 0 0 0 0.2rem rgba(74, 124, 89, 0.25);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-tree"></i> Forest Analysis Dashboard
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/interface">
                    <i class="fas fa-search"></i> Analysis Tool
                </a>
                <a class="nav-link" href="/">
                    <i class="fas fa-home"></i> Home
                </a>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3">
                <div class="sidebar">
                    <h6><i class="fas fa-filter"></i> Filters</h6>
                    
                    <div class="filter-group">
                        <label for="regionFilter" class="form-label">Region</label>
                        <select class="form-select" id="regionFilter">
                            <option value="">All Regions</option>
                            <option value="amazon">Amazon Basin</option>
                            <option value="congo">Congo Basin</option>
                            <option value="se_asia">Southeast Asia</option>
                            <option value="boreal">Boreal Forest</option>
                            <option value="temperate">Temperate Forest</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="riskFilter" class="form-label">Risk Level</label>
                        <select class="form-select" id="riskFilter">
                            <option value="">All Risk Levels</option>
                            <option value="critical">Critical</option>
                            <option value="very_high">Very High</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="landUseFilter" class="form-label">Land Use</label>
                        <select class="form-select" id="landUseFilter">
                            <option value="">All Land Uses</option>
                            <option value="natural_forest">Natural Forest</option>
                            <option value="urban_core">Urban Core</option>
                            <option value="suburban">Suburban</option>
                            <option value="agricultural">Agricultural</option>
                            <option value="desert">Desert</option>
                        </select>
                    </div>

                    <button class="btn btn-primary w-100" onclick="applyFilters()">
                        <i class="fas fa-search"></i> Apply Filters
                    </button>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9">
                <!-- Statistics Cards -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-value" id="totalAnalyses">0</div>
                            <div class="stat-label">Total Analyses</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-value" id="avgRiskScore">0%</div>
                            <div class="stat-label">Avg Risk Score</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-value" id="highRiskAreas">0</div>
                            <div class="stat-label">High Risk Areas</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-value" id="systemStatus">Online</div>
                            <div class="stat-label">System Status</div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-chart-pie"></i> Risk Distribution</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="riskChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-chart-bar"></i> Forest Cover by Region</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="forestChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Map and Data Table -->
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-globe"></i> Global Forest Map</h5>
                            </div>
                            <div class="card-body">
                                <div id="map"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-table"></i> Recent Analyses</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Location</th>
                                                <th>Risk</th>
                                                <th>Cover %</th>
                                                <th>Type</th>
                                            </tr>
                                        </thead>
                                        <tbody id="analysesTable">
                                            <!-- Data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    
    <script>
        // Initialize map
        const map = L.map('map').setView([0, 0], 2);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);

        // Sample data for demonstration
        const sampleData = [
            { lat: -10.123, lon: -60.456, region: 'Amazon Basin', risk: 'high', cover: 85.2, type: 'tropical_rainforest' },
            { lat: 40.7128, lon: -74.0060, region: 'New York', risk: 'critical', cover: 12.5, type: 'urban' },
            { lat: 51.5074, lon: -0.1278, region: 'London', risk: 'high', cover: 18.3, type: 'urban' },
            { lat: 35.6762, lon: 139.6503, region: 'Tokyo', risk: 'critical', cover: 8.7, type: 'urban' },
            { lat: -23.5505, lon: -46.6333, region: 'SÃ£o Paulo', risk: 'medium', cover: 45.8, type: 'suburban' },
            { lat: 0.0, lon: 20.0, region: 'Congo Basin', risk: 'low', cover: 92.1, type: 'tropical_rainforest' },
            { lat: 60.0, lon: 100.0, region: 'Siberian Forest', risk: 'low', cover: 78.4, type: 'boreal_forest' },
            { lat: 10.0, lon: 110.0, region: 'Southeast Asia', risk: 'medium', cover: 65.3, type: 'tropical_rainforest' }
        ];

        let riskChart, forestChart;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            loadSampleData();
            updateStatistics();
        });

        function initializeCharts() {
            // Risk Distribution Chart
            const riskCtx = document.getElementById('riskChart').getContext('2d');
            riskChart = new Chart(riskCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Low Risk', 'Medium Risk', 'High Risk', 'Critical'],
                    datasets: [{
                        data: [0, 0, 0, 0],
                        backgroundColor: [
                            '#3498db',
                            '#f39c12',
                            '#e74c3c',
                            '#8e44ad'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Forest Cover Chart
            const forestCtx = document.getElementById('forestChart').getContext('2d');
            forestChart = new Chart(forestCtx, {
                type: 'bar',
                data: {
                    labels: ['Amazon', 'Congo', 'Southeast Asia', 'Boreal', 'Temperate'],
                    datasets: [{
                        label: 'Forest Cover %',
                        data: [0, 0, 0, 0, 0],
                        backgroundColor: '#2d5016'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        function loadSampleData() {
            // Add markers to map
            sampleData.forEach(item => {
                const marker = L.marker([item.lat, item.lon]).addTo(map);
                marker.bindPopup(`
                    <strong>${item.region}</strong><br>
                    Risk: <span class="risk-${item.risk}">${item.risk.toUpperCase()}</span><br>
                    Cover: ${item.cover}%<br>
                    Type: ${item.type.replace('_', ' ')}
                `);
            });

            // Populate table
            const tableBody = document.getElementById('analysesTable');
            tableBody.innerHTML = sampleData.map(item => `
                <tr>
                    <td>${item.region}</td>
                    <td><span class="risk-indicator risk-${item.risk}">${item.risk}</span></td>
                    <td>${item.cover}%</td>
                    <td>${item.type.replace('_', ' ')}</td>
                </tr>
            `).join('');

            // Update charts
            updateCharts();
        }

        function updateCharts() {
            // Count risk levels
            const riskCounts = {
                low: sampleData.filter(item => item.risk === 'low').length,
                medium: sampleData.filter(item => item.risk === 'medium').length,
                high: sampleData.filter(item => item.risk === 'high').length,
                critical: sampleData.filter(item => item.risk === 'critical').length
            };

            // Update risk chart
            riskChart.data.datasets[0].data = [
                riskCounts.low,
                riskCounts.medium,
                riskCounts.high,
                riskCounts.critical
            ];
            riskChart.update();

            // Update forest chart
            const regionData = {
                'Amazon': sampleData.find(item => item.region.includes('Amazon'))?.cover || 0,
                'Congo': sampleData.find(item => item.region.includes('Congo'))?.cover || 0,
                'Southeast Asia': sampleData.find(item => item.region.includes('Southeast'))?.cover || 0,
                'Boreal': sampleData.find(item => item.region.includes('Siberian'))?.cover || 0,
                'Temperate': 0
            };

            forestChart.data.datasets[0].data = Object.values(regionData);
            forestChart.update();
        }

        function updateStatistics() {
            document.getElementById('totalAnalyses').textContent = sampleData.length;
            
            const avgRisk = sampleData.reduce((sum, item) => {
                const riskValues = { low: 0.2, medium: 0.5, high: 0.8, critical: 1.0 };
                return sum + riskValues[item.risk];
            }, 0) / sampleData.length;
            
            document.getElementById('avgRiskScore').textContent = (avgRisk * 100).toFixed(1) + '%';
            
            const highRiskCount = sampleData.filter(item => 
                item.risk === 'high' || item.risk === 'critical'
            ).length;
            
            document.getElementById('highRiskAreas').textContent = highRiskCount;
            document.getElementById('systemStatus').textContent = 'Online';
        }

        function applyFilters() {
            const regionFilter = document.getElementById('regionFilter').value;
            const riskFilter = document.getElementById('riskFilter').value;
            const landUseFilter = document.getElementById('landUseFilter').value;

            let filteredData = sampleData;

            if (regionFilter) {
                filteredData = filteredData.filter(item => 
                    item.region.toLowerCase().includes(regionFilter.toLowerCase())
                );
            }

            if (riskFilter) {
                filteredData = filteredData.filter(item => item.risk === riskFilter);
            }

            if (landUseFilter) {
                filteredData = filteredData.filter(item => item.type === landUseFilter);
            }

            // Update table
            const tableBody = document.getElementById('analysesTable');
            tableBody.innerHTML = filteredData.map(item => `
                <tr>
                    <td>${item.region}</td>
                    <td><span class="risk-indicator risk-${item.risk}">${item.risk}</span></td>
                    <td>${item.cover}%</td>
                    <td>${item.type.replace('_', ' ')}</td>
                </tr>
            `).join('');

            // Update statistics
            document.getElementById('totalAnalyses').textContent = filteredData.length;
        }

        // Auto-refresh every 30 seconds
        setInterval(() => {
            updateStatistics();
        }, 30000);
    </script>
</body>
</html>